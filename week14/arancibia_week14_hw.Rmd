---
title: "IS 622 Week 14 Homework"
author: "Ben Arancibia"
date: "November 28, 2015"
output:
  pdf_document:
    latex_engine: xelatex
---

__10.5.1__

Suppose graphs are generated by picking a probability p and choosing each edge independently with probability p, as in Example 10.21. For the graph of Fig. 10.20, what value of p gives the maximum likelihood of seeing that graph? What is the probability this graph is generated?

![Figure 10.9](//users/bcarancibia/CUNY_IS_622/week14/1020.png)

There are 6 possible edges. The probability this graph is generated is:
$$p^4(1-p)^2$$

To find the the value of p that maximizes this you must do the derivate and solve for 0:

$$(d/dp)=p^4(1-p)^2$$

$$p^4(2(1-p)(-1)) + (1-p)^2(4p^3) = 0$$

$$2p^5 - 2p^4 + (1 -2p +p^2)(4p^3) = 0$$

$$2p^5 - 2p^4 + 4p^3 - 8p^4 + 4p^5 = 0$$

$$2(3p^5 - 5p^4 + 2p^3) = 0$$

$$p^3(3p^2 - 5p + 2) = 0 $$

$$p^3(3p - 2)(p - 1) = 0 $$

$$p^3 = 0$$ , $$(3p-2) = 0$$, $$(p-1) = 0$$

The value of p that maximizes the probability is 2/3.

$(2/3)^4(1 - 2/3)^2$ = $0.02194787$

__10.7.1__

How many triangles are there in the graphs: 

```{r, echo=FALSE, warning=FALSE, message=FALSE,results='hide'}
library(dplyr)

triangles <- function(edges) {
  names(edges) <- c("A", "B")
  return(
    inner_join(
      inner_join(edges, edges, by=c("B" = "A")),
      edges, by="A"
    ) %>%
      setNames(., c("X", "Y", "Z1", "Z2")) %>%
      filter(Z1 == Z2) %>%
      select(X, Y, Z1) %>%
      setNames(., c("Vertex 1", "Vertex 2", "Vertex 3"))
    
  )
}


```
(a) Figure 10.1.

```{r, echo=FALSE}
a <- as.data.frame(matrix(c("A", "B",
                           "A", "C",
                           "B", "C",
                           "B", "D",
                           "D", "E",
                           "D", "F",
                           "D", "G",
                           "E", "F",
                           "F", "G"),
                         ncol = 2,
                         byrow = TRUE))
colnames(a) <- c("A", "B")
```

```{r, warning=FALSE}
triangles(a)
```

(b) Figure 10.9.

```{r, echo=FALSE}
b <- as.data.frame(
  matrix(c("A", "B",
           "A", "C",
           "B", "C",
           "B", "H",
           "C", "D",
           "D", "E",
           "D", "F",
           "E", "F",
           "E", "G",
           "G", "H",
           "G", "I",
           "H", "I"
            ),
         ncol = 2, 
         byrow = TRUE)
  )
colnames(b) <- c("A", "B")
```

```{r, warning=FALSE}
triangles(b)
```

(c) Figure 10.2.

```{r, echo=FALSE}
c <- as.data.frame(
  matrix(c("T1", "U1",
           "T1", "W1",
           "T2", "U1",
           "T2", "U2",
           "T2", "W1",
           "T2", "W2",
           "T2", "W3",
           "T3", "U1",
           "T3", "U2",
           "T3", "W2",
           "T4", "U2",
           "T4", "W2",
           "T4", "W3",
           "U1", "W1",
           "U1", "W2",
           "U2", "W2",
           "U2", "W3"
           ), 
         ncol = 2, 
         byrow = TRUE)
  )
colnames(c) <- c("A", "B")

```

```{r, warning=FALSE}
triangles(c)
```


